\section{Cubic splines}
\label{sec:cubic-splines}

\begin{itemize}
\item parametric cubic splines \cite{McCulloch1971, McCulloch1975}
\item non-parametric splines \cite{Adams1994,Fisher1995, Waggoner1997, Tanggaard1997, Shea1985}
\item \cite{Shea1985} mentions unstable fluctuating forward rates in \cite{McCulloch1975} cubic splines

\end{itemize}

Discount function

\begin{equation}
  \label{eq:df_spline}
  d(m_{i,j})=1+\sum_{l=1}^k\alpha_lg^l(m_{i,j})
\end{equation}

\subsection{Knot point selection}

\cite{McCulloch1975} defines a $k$-parameter spline with $k-1$ knot points $q_l$. We sort the cashflow matrix $\bm{C}$ and the maturity matrix $\bm{M}$ such that the $m$ bonds are arranged in ascending order by their maturity dates. The following specification places an approximately equal number of bonds between adjacent knots. It sets $q_1=0$ and $q_{k-1}=m_m$. $m_j$ is the maturity date of the $j$-th bond. For $1<l<k-1$ we find the further knot points.

\begin{equation}
  \label{eq:A.1a}
  q_l = m_h+\theta(m_{h+1}-m_h)
\end{equation}

where

\begin{equation}
 \label{eq:A.1b}
  h = \mbox{greates integer in }\frac{(l-1)m}{k-2}
\end{equation}

and

\begin{equation}
  \label{eq:A.1c}
  \theta = \frac{(l-1)m}{k-2}-h.
\end{equation}

\cite{McCulloch1971} sets the  number of basis functions $k$ to the integer nearest to the square root of the number of observed bonds. This allows a smooth fit of the discount function.

\begin{equation}
  \label{eq:nofknots}
  k = \mbox{INT}\left[\sqrt{m}\right]
\end{equation}


allgemeiner Satz über Funktionen ....
In order to generate the family of cubic splines relative to these knots, we define for $m_{ij}<q_{l-1}$

\begin{equation}
  \label{eq:A.2}
  g^l(m_{i,j})=0.
\end{equation}


For $q_{l-1}\leq m_{ij} <q_l$, we define

\begin{equation}
  \label{eq:A.3}
  g^l(m_{i,j})=\frac{(m_{ij}-q_{l-1})^3}{6(q_l-q_{l-1})}
\end{equation}

When $q_l\leq m_{ij}< q_{l+1}$, we define

\begin{equation}
  \label{eq:A.4a}
  g^l(m_{i,j}) = \frac{c^2}{6}+\frac{ce}{2}+\frac{e^2}{2}-\frac{e^3}{6(q_{l+1}-q_l)}
\end{equation}

where

\begin{equation}
  \label{eq:A.4b}
  c = q_l-q_{l-1}
\end{equation}

and $e$ is the 

\begin{equation}
  \label{eq:A.4c}
  e = m_{ij}-q_l
\end{equation}

For $q_{l+1}\leq m_{ij}$, define

\begin{equation}
  \label{eq:A.5}
  g^l(m_{i,j}) = (q_{l+1}-q_{l-1})\left[\frac{2q_{l+1}-q_l-q_{l-1}}{6}+\frac{m_{ij}-q_{l+1}}{2}\right]
\end{equation}

(Set $q_{l-1}=q_l=0$ when $l=1$.)

The above formulas apply when $l<k$. When $l=k$, we define

\begin{equation}
  \label{eq:A.6}
 g^l(m_{i,j})= m_{ij},
\end{equation}

regardless of $m_{ij}$.

The basis functions in equations \eqref{eq:A.2}-\eqref{eq:A.6} are calulated for the maturities of each cashflow $m_{i,j}$ and summarized in the matrix

\begin{equation}
\label{eq:basisfctmatrix}	
\bm{G}_{\left [n \times m\right]}^l= \{g_{ij}^l\}.
\end{equation}
where $g_{i,j}^l=g^l(m_{i,j})$.



\subsection{Regression fitting of the discount function}

We estimate the unknown parameters in \eqref{eq:df_spline} with OLS.  We fit for $l=1\dots k$ basis functions 

	$$\bm{X}_{\left[m \times k\right]}=\{ \bm{x}_{\left[m \times 1\right]} \} \qquad  \bm{x}_{\left[m \times 1\right]} = \left( \iota_{\left[1\times n\right]} \bm{C}_{\left[n\times m\right]} \cdot \bm{G}^l_{\left[n\times m\right]}\right)^\top$$

	

	$$\bm{y}_{\left[m \times 1\right]}=  \bm{p}^d_{\left[1\times m\right]}  - \iota_{\left[1\times n\right]} \bm{C}_{\left[n\times m\right]}   $$
Whereas $(\cdot)$ denotes again a element by element multiplication and $( )^{\top}$ the transposed matrix (vector)



Parameter estimation with OLS.
	
\begin{equation}
\label{eq:paramspline}
\bm{\hat \alpha}_{\left[s \times 1\right]}= \left( \bm{X}^t   \bm{X}\right )^{-1}\bm{X}^t \bm{y}
\end{equation}

Discount function

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "jss-termstrc"
%%% End: 
