\section{Zero-coupon yield curve estimation}
\label{sec:zcy-estim}

In this section, we define a matrix-oriented notation and briefly describe the estimation procedure which is important for the implementation of the \pkg{termstrc} package described in this paper.

\subsection{Notation}
\label{sec:notation}

Let us establish the necessary notation for a market data set of coupon bonds. We denote an element-wise multiplication with ``$\cdot$'' and $( )'$ is the transpose of a matrix. $\bm{\iota}$ defines a column vector filled with ones.

\subsubsection*{Maturity matrix}

\begin{equation*}\label{maturitym}
\bm{M}_{\left[n\times m\right]}= \{m_{ij}\}
\end{equation*}

The number of rows $n$ is determined by the number of cashflows of the $j$-th bond with the longest maturity. Dates after the maturity of the bond $j$ are filled up with zeros till the maturity date of the bond with the longest maturity. One element $m_{ij}$ of this matrix refers, therefore, to the time to occurence (in days) of the $i$-th cashflow of the $j$-th bond. 

\subsubsection*{Maturity vector}

We denote with $m_j$ the maturity of the last cashflow, i.e. the maturity of the $j$-th bond.

\begin{equation*}\label{weights}
    \bm{m}_{\left[1\times m\right]}= \{m_j\}
\end{equation*}

\subsubsection*{Cashflow matrix}


 \begin{equation*}\label{cashflowm}
\bm{C}_{\left[n\times m\right]}= \{c_{ij}\}
\end{equation*}

The cashflow matrix is defined analogously to the maturity matrix. One element $c_{ij}$ refers to the $i$-th cashflow of the $j$-th bond. Note, that the last cashflow of a each bond includes the redemption payment.

\subsubsection*{Discount factor matrix}

 \begin{equation*}\label{discountm}
\bm{D}_{\left[n\times m\right]}= \{d_{ij}\}
\end{equation*}

One element $d_{ij}$ of the matrix refers to the discount factor associated with the $i$-th cashflow of the $j$-th bond. The discount function $\delta(m_{ij})$ returns the discount factor for a given maturity. In the following sections we present several methods how to estimate it. From an economic point of view only positive interest rates are appropriate. This implies that the discount factors are nonnegative where the entries in the maturity matrix are greater than zero. Remember, zero entries in the maturity matrix mean that for these points in time now cash flows exist.

\subsubsection*{Clean price vector}

 \begin{equation*}\label{pc}
\bm{p}^c_{\left[1\times m\right]}= \{p^c_j\}
\end{equation*}

$p_{j}^c$ is the quoted market price of the $j$-th bond. It is given as percentage of the nominal value.

\subsubsection*{Accrued interest vector}

When an investor buys a bond, he obtains the right to receive all its future cash flows. If the purchase occurs between two coupon dates, the seller must be compensated for the fraction of the next coupon, the so-called \emph{accrued interest}

  \begin{equation*}\label{a}
\bm{a}_{\left[1\times m\right]}= \{a_j\}.
\end{equation*}


In practice, the calculation depends on the used day-count convention, e.g. 30/360, Actual/360. A basic form for the $j$-th bond is as follows:

\begin{equation*}
    a_j= \frac{\mbox{number of days since last coupon payment}}{\mbox{number of days in current coupon period}}\cdot \mbox{coupon}_j.
\end{equation*}
 	

\subsubsection*{Dirty price vector}

The dirty price vector is the sum of the clean price and the accrued interest.

\begin{displaymath}
\bm{p}=\bm{p}^c+\bm{a}
\end{displaymath}

The elements are denoted by 
\begin{equation*}\label{pd}
    \bm{p}_{\left[1\times m\right]}= \{p_j\}\,.
\end{equation*}


\subsubsection*{Yield-to-maturity vector}

This vector contains the yield-to-maturity described in \eqref{eq:yield}.

\begin{equation*}\label{pd}
    \bm{y}_{\left[1\times m\right]}= \{y_j\}
\end{equation*}



\subsubsection*{Duration vector}

To obtain an indicator for the sensitivity of a bond's price against changes in the interest rate, one needs to account for the fact that coupons are paid during the lifetime of a bond. A standard measure of risk is the (Macaulay) \emph{duration} which computes the average maturity of a bond using the present values of its cash flows as weights.



\begin{equation*}
  \label{eq:macaulayduration}
  \bm{d}_{\left[1\times m\right]} = \frac{\bm{\iota}'(\bm{C}\cdot\bm{M}\cdot\bm{D})}{\bm{\iota}'(\bm{C}\cdot\bm{D})}
\end{equation*}

Here, the discount matrix $\bm{D}$ contains the disount factors calulated with the yield-to-maturity of each bond as in \eqref{eq:yield}.

\subsubsection*{Weights matrix}

In the next section, we will use the following matrix for weighting the estimation errors:


\begin{equation*}\label{weights}
    \bm{\Omega}_{\left[m\times m\right]}= \begin{pmatrix}
 \omega_1 & 0 &\cdots  &0  \\
 0 & \omega_2 &  & \vdots \\
 \vdots &  & \ddots & 0 \\
 0 &\cdots  &0  & \omega_m
\end{pmatrix},
\end{equation*}


whereas $\omega_j$ is the weight for bond $j$ with duration $d_j$.

\begin{equation}
\label{eq:durationweight}
    \omega_j=\frac{\frac{1}{d_j}}{\sum_{i=1}^m\frac{1}{d_i}}
\end{equation}


%\newpage
\subsection{Estimation procedure}
\label{sec:estimation}

The simplest smoothing technique is linear interpolation. In many cases it is not appropriate for zero-coupon yield curve estimation, because it can lead to spikes in the forward rate curve, which is economically implausible. Therefore, we use indirect estimation procedures that postulate a specific form for the spot rate function $s(m_{ij}, \bm{\beta})$ or the discount function $\delta(m_{ij}, \bm{\beta})$, where $\bm{\beta}$ is a vector of parameters \citep[see, e.g.][]{Martellini2003}. This allows us to construct a discount matrix. The \emph{theoretical bond prices} are then defined as sums of the discounted cash flows of each bond

\begin{equation}
  \label{eq:theorprices}
  \bm{\hat{p}} = \bm{\iota}'(\bm{C}\cdot\bm{D}).
\end{equation}



The \emph{pricing errors}
\begin{equation*}
  \label{eq:pricingerrors}
  \bm{\epsilon}_p = \bm{p-\hat{p}}
\end{equation*}

are the deviation of the theoretical prices from the dirty prices observed on the market. Analogously, we can define the \emph{yield errors}


\begin{equation*}
  \label{eq:yielderrors}
  \bm{\epsilon}_y = \bm{y-\hat{y}},
\end{equation*}

where $\hat{\bm{y}}$ are the yield-to-maturities based on the theoretical bond prices. The errors satisfy

\begin{eqnarray*}
  \label{eq:residuals}
  \E(\bm{\epsilon}) &=& \bm{0}\,,\\
  \VAR(\bm{\epsilon}) &=&\sigma^2\bm{\Omega}^2\,,\\
  \COV(\epsilon_i, \epsilon_j) &=& 0 \quad \mbox{for}\,i\neq j\, .
\end{eqnarray*}

The goal is to find the parameters that minimize the weighted squared errors.


\begin{equation}
  \label{eq:optimalparam}
  \hat{\bm{\beta}}= \argmin_{\hat{\bm{\beta}}}\bm{\iota}'(\bm{\epsilon}^2\bm{\Omega})'
\end{equation}

The goodness of fit can be measured for example with the \emph{root mean squared error}

\begin{equation*}
  \label{eq:rmse}
  \mbox{RMSE}=\sqrt{\frac{1}{m}\bm{\epsilon}^2\bm{\iota}}\,,
\end{equation*}

or the \emph{mean absolute error}

\begin{equation*}
  \label{eq:mae}
  \mbox{MAE}=\frac{1}{m}|\bm{\epsilon}|\bm{\iota}\,.
\end{equation*}

The next two sections present popular ways to specify a functional form for the spot rate or the discount function and solve the optimization problem given in \eqref{eq:optimalparam}.


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "jss-termstrc"
%%% End: 
