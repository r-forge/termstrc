\subsection{Nelson/Siegel}

\begin{Schunk}
\begin{Sinput}
> library(termstrc)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> data(govbonds)
> group <- c("GERMANY", "FRANCE", "BELGIUM", "SPAIN")
> bonddata <- govbonds
> matrange <- c(0, 30)
> method <- "Nelson/Siegel"
> fit <- "prices"
> weights <- "duration"
> control <- list(eval.max = 1e+05, iter.max = 500)
> b <- matrix(rep(c(0, 0, 0, 1), 4), nrow = 4, ncol = 4, byrow = TRUE)
> rownames(b) <- group
> colnames(b) <- c("beta0", "beta1", "beta2", "tau1")
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> x <- nelson_estim(group, bonddata, matrange, method, fit, weights, 
+     startparam = b, control)
> print(x)
\end{Sinput}
\begin{Soutput}
---------------------------------------------------
Parameters for Nelson/Siegel, Svensson estimation:

Method: Nelson/Siegel 
Fitted: prices 
Weights: duration 

---------------------------------------------------

           GERMANY      FRANCE      BELGIUM        SPAIN
beta_0  0.05130485  0.05118613  0.052087336  0.052729208
beta_1 -0.01268934 -0.01242461 -0.008902787  0.002793829
beta_2 -0.03215030 -0.03036739 -0.036863081 -0.047882040
tau_1   2.68940960  2.54290444  2.185687966  1.863315461

---------------------------------------------------
Parameters for Nelson/Siegel, Svensson estimation:

Method: Nelson/Siegel 
Fitted: prices 
Weights: duration 

---------------------------------------------------

           GERMANY      FRANCE      BELGIUM        SPAIN
beta_0  0.05130485  0.05118613  0.052087336  0.052729208
beta_1 -0.01268934 -0.01242461 -0.008902787  0.002793829
beta_2 -0.03215030 -0.03036739 -0.036863081 -0.047882040
tau_1   2.68940960  2.54290444  2.185687966  1.863315461
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> summary(x)
\end{Sinput}
\begin{Soutput}
---------------------------------------------------
Goodness of fit:
---------------------------------------------------

                  GERMANY       FRANCE     BELGIUM       SPAIN
RMSE-Prices  0.3578726994 0.2214576932 2.222911540 2.011818320
AABSE-Prices 0.2030132846 0.1184783548 0.776049452 1.724348859
RMSE-Yields  0.0008413222 0.0003923194 0.005007131 0.008045454
AABSE-Yields 0.0005305512 0.0002735921 0.002114202 0.005710166


---------------------------------------------------
Convergence information:
---------------------------------------------------

        Convergence ()
GERMANY "converged"   
FRANCE  "converged"   
BELGIUM "converged"   
SPAIN   "converged"   

        Solver message            
GERMANY "relative convergence (4)"
FRANCE  "relative convergence (4)"
BELGIUM "relative convergence (4)"
SPAIN   "relative convergence (4)"
\end{Soutput}
\end{Schunk}

\begin{center}
\begin{Schunk}
\begin{Sinput}
> plot(x, multiple = TRUE, errors = "none")
\end{Sinput}
\end{Schunk}
\includegraphics{example-005}
\end{center}

\subsection{Cubic Splines}

\begin{Schunk}
\begin{Sinput}
> data(govbonds)
> bonddata <- govbonds
> matrange <- c(0, 30)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> f <- splines_estim(group = c("FRANCE"), bonddata, matrange)
> print(f)
\end{Sinput}
\begin{Soutput}
---------------------------------------------------
Parameters for Cubic splines estimation:

[1] "FRANCE:"
      alpha 1       alpha 2       alpha 3       alpha 4       alpha 5 
 0.0136620572 -0.0018022601 -0.0003772906  0.0001867318  0.0010633259 
      alpha 6       alpha 7 
 0.0014693772 -0.0408879155 
\end{Soutput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> summary(f)
\end{Sinput}
\begin{Soutput}
---------------------------------------------------
Goodness of fit:
---------------------------------------------------

                   FRANCE
RMSE-Prices  0.1819767236
AABSE-Prices 0.0820766103
RMSE-Yields  0.0005212926
AABSE-Yields 0.0002514331

---------------------------------------------------
Summary statistics for the fitted models:
---------------------------------------------------

$FRANCE

Call:
lm(formula = -Y[[k]] ~ X[[k]] - 1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.663324 -0.030923 -0.007992  0.041845  0.908719 

Coefficients:
          Estimate Std. Error t value Pr(>|t|)    
alpha 1  0.0136621  0.0072072   1.896    0.066 .  
alpha 2 -0.0018023  0.0020768  -0.868    0.391    
alpha 3 -0.0003773  0.0008139  -0.464    0.646    
alpha 4  0.0001867  0.0002862   0.652    0.518    
alpha 5  0.0010633  0.0001208   8.804 1.66e-10 ***
alpha 6  0.0014694  0.0002102   6.989 3.39e-08 ***
alpha 7 -0.0408879  0.0032007 -12.774 6.14e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 0.1989 on 36 degrees of freedom
Multiple R-Squared:     1,	Adjusted R-squared:     1 
F-statistic: 3.211e+05 on 7 and 36 DF,  p-value: < 2.2e-16 
\end{Soutput}
\end{Schunk}

\begin{center}
\begin{Schunk}
\begin{Sinput}
> plot(f, errors = "none")
\end{Sinput}
\end{Schunk}
\includegraphics{example-009}
\end{center}



\begin{center}
\begin{Schunk}
\begin{Sinput}
> plot(f, ctype = "none", inset = c(0.2, 0.4))
\end{Sinput}
\end{Schunk}
\includegraphics{example-010}
\end{center}


\begin{Schunk}
\begin{Sinput}
> e <- splines_estim(group = c("FRANCE"), bonddata = rm_bond(bonddata, 
+     c("FR0000571044", "FR0000571085"), "FRANCE"), matrange)
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> summary(e)
\end{Sinput}
\begin{Soutput}
---------------------------------------------------
Goodness of fit:
---------------------------------------------------

                   FRANCE
RMSE-Prices  0.0615589340
AABSE-Prices 0.0515614078
RMSE-Yields  0.0003452360
AABSE-Yields 0.0002025576

---------------------------------------------------
Summary statistics for the fitted models:
---------------------------------------------------

$FRANCE

Call:
lm(formula = -Y[[k]] ~ X[[k]] - 1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.10516 -0.03516 -0.01789  0.05302  0.14043 

Coefficients:
          Estimate Std. Error t value Pr(>|t|)    
alpha 1  8.886e-03  1.558e-03   5.704 1.89e-06 ***
alpha 2 -9.269e-04  3.869e-04  -2.396   0.0221 *  
alpha 3 -5.500e-04  1.175e-04  -4.682 4.17e-05 ***
alpha 4  9.038e-04  3.307e-05  27.334  < 2e-16 ***
alpha 5  1.526e-03  5.085e-05  30.005  < 2e-16 ***
alpha 6 -3.921e-02  8.287e-04 -47.318  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 0.06663 on 35 degrees of freedom
Multiple R-Squared:     1,	Adjusted R-squared:     1 
F-statistic: 2.856e+06 on 6 and 35 DF,  p-value: < 2.2e-16 
\end{Soutput}
\end{Schunk}
